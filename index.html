<!doctype html>
<html lang="en">
<head>
<meta charset="utf-8" />
<meta name="viewport" content="width=device-width,initial-scale=1" />
<title>Tic Tac Toe â€” Portfolio Project</title>
<style>
  :root{
    --accent:#7dd3fc;
    --muted:#94a3b8;
    --win: #34d399;
    font-family: Inter, system-ui, -apple-system, "Segoe UI", Roboto, "Helvetica Neue", Arial;
  }

  html, body{
    height:100%;
    margin:0;
    color:#e6eef6;
    transition: background 0.3s ease;
  }

  .wrap{min-height:100%;display:flex;align-items:center;justify-content:center;padding:24px;}
  .card{border-radius:12px; padding:20px; width:min(720px,96vw); box-shadow:0 10px 30px rgba(2,6,23,0.7); transition: background 0.3s ease;}
  
  header{display:flex;gap:16px;align-items:center;justify-content:space-between;margin-bottom:12px;}
  h1{font-size:18px;margin:0;color:var(--accent);}
  .controls{display:flex;gap:8px;align-items:center;}
  select, button{background:transparent;border:1px solid rgba(255,255,255,0.06);color:var(--muted);padding:8px 10px;border-radius:8px;}
  button{cursor:pointer}
  .board{display:grid;grid-template-columns:repeat(3,1fr);gap:10px;padding:18px;background:rgba(255,255,255,0.02);border-radius:8px;}
  .cell{aspect-ratio:1/1;display:flex;align-items:center;justify-content:center;font-size:48px;background:linear-gradient(180deg, rgba(255,255,255,0.01), transparent);border-radius:8px;cursor:pointer;user-select:none;transition:transform .08s ease, box-shadow .12s;}
  .cell:hover{transform:translateY(-3px)}
  .muted{font-size:13px;color:var(--muted);margin-top:10px;}
  .status{display:flex;gap:12px;align-items:center;margin-bottom:12px;}
  .score{display:flex;gap:8px;align-items:center;}
  .score .item{background:rgba(255,255,255,0.02);padding:6px 8px;border-radius:8px;font-size:13px}
  .winner{color:var(--win);font-weight:700}
  .highlight{box-shadow:0 6px 18px rgba(52,211,153,0.14);background:linear-gradient(180deg, rgba(52,211,153,0.08), rgba(52,211,153,0.02));}
  .footer{display:flex;justify-content:space-between;align-items:center;margin-top:12px;font-size:13px;color:var(--muted)}
  .small{font-size:12px;color:var(--muted)}
  
  @media (max-width:480px){
    .cell{font-size:32px}
    header{flex-direction:column;align-items:flex-start;gap:8px}
  }
</style>
</head>
<body>
  <div class="wrap">
    <div class="card" role="application" aria-label="Tic Tac Toe game">
      <header>
        <h1>ðŸŽ¯ Tic Tac Toe</h1>
        <div class="controls">
          <label class="small" for="mode">Mode</label>
          <select id="mode">
            <option value="pvp">2-Player (local)</option>
            <option value="pve">Single Player vs AI</option>
          </select>
          <label class="small" for="ai-level">AI</label>
          <select id="ai-level">
            <option value="random">Easy (random)</option>
            <option value="minimax">Hard (minimax)</option>
          </select>
          <label class="small" for="theme">Theme</label>
          <select id="theme">
            <option value="dark">Dark</option>
            <option value="sunset">Sunset</option>
            <option value="ocean">Ocean</option>
            <option value="forest">Forest</option>
          </select>
          <button id="undoBtn">Undo</button>
          <button id="resetBtn">Restart</button>
        </div>
      </header>

      <div class="status">
        <div class="score">
          <div class="item">X: <span id="scoreX">0</span></div>
          <div class="item">O: <span id="scoreO">0</span></div>
          <div class="item">Draws: <span id="scoreD">0</span></div>
        </div>
        <div style="margin-left:auto" id="turnInfo">Turn: <strong id="turn">X</strong></div>
      </div>

      <main>
        <div class="board" id="board" aria-live="polite">
          <div class="cell" data-index="0"></div>
          <div class="cell" data-index="1"></div>
          <div class="cell" data-index="2"></div>
          <div class="cell" data-index="3"></div>
          <div class="cell" data-index="4"></div>
          <div class="cell" data-index="5"></div>
          <div class="cell" data-index="6"></div>
          <div class="cell" data-index="7"></div>
          <div class="cell" data-index="8"></div>
        </div>
        <div class="muted">Click a cell to play. Try beating the Minimax AI ðŸ˜‰</div>
      </main>

      <div class="footer">
        <div class="small">Built for portfolio â€” includes AI & undo.</div>
        <div><button id="downloadBtn">Export Board</button></div>
      </div>
    </div>
  </div>

<script>
// --- Theme Logic ---
const themeEl = document.getElementById('theme');
const cardEl = document.querySelector('.card');

const themes = {
  dark: {bg:'#0f1724', card:'#0b1220', accent:'#7dd3fc'},
  sunset: {bg:'linear-gradient(180deg, #ff7e5f, #feb47b)', card:'rgba(255,255,255,0.05)', accent:'#ffdd99'},
  ocean: {bg:'linear-gradient(180deg, #2193b0, #6dd5ed)', card:'rgba(255,255,255,0.05)', accent:'#a0e7e5'},
  forest: {bg:'linear-gradient(180deg, #134e4a, #16a34a)', card:'rgba(255,255,255,0.05)', accent:'#b7f5d0'}
};

function applyTheme(themeName){
  const t = themes[themeName];
  document.body.style.background = t.bg;
  cardEl.style.background = t.card;
  document.documentElement.style.setProperty('--accent', t.accent);
}

// Apply theme on change
themeEl.addEventListener('change', e => applyTheme(e.target.value));

// Initialize default
applyTheme('dark');

// --- Tic Tac Toe logic ---
let board = Array(9).fill(null);
let currentPlayer = 'X';
let isGameOver = false;
let history = [];
let scores = {X:0, O:0, D:0};

const cells = [...document.querySelectorAll('.cell')];
const turnEl = document.getElementById('turn');
const modeEl = document.getElementById('mode');
const aiLevelEl = document.getElementById('ai-level');
const resetBtn = document.getElementById('resetBtn');
const undoBtn = document.getElementById('undoBtn');
const scoreX = document.getElementById('scoreX');
const scoreO = document.getElementById('scoreO');
const scoreD = document.getElementById('scoreD');
const downloadBtn = document.getElementById('downloadBtn');

const WIN_LINES = [
  [0,1,2],[3,4,5],[6,7,8],
  [0,3,6],[1,4,7],[2,5,8],
  [0,4,8],[2,4,6]
];

function render(){
  cells.forEach((c,i)=>{
    c.textContent = board[i] || '';
    c.classList.remove('highlight');
  });
  turnEl.textContent = currentPlayer;
}

function checkWinner(bd){
  for(const line of WIN_LINES){
    const [a,b,c] = line;
    if(bd[a] && bd[a] === bd[b] && bd[a] === bd[c]) return {winner: bd[a], line};
  }
  if(bd.every(x => x)) return {winner: 'draw'};
  return null;
}

function setStatusWinner(winner, winningLine){
  isGameOver = true;
  if(winner === 'draw'){
    scores.D += 1;
    scoreD.textContent = scores.D;
    alert("It's a draw!");
  } else {
    scores[winner] += 1;
    if(winner === 'X') scoreX.textContent = scores.X;
    else scoreO.textContent = scores.O;
    winningLine.forEach(i => cells[i].classList.add('highlight'));
    alert(`${winner} wins!`);
  }
}

function makeMove(i, player){
  if(isGameOver || board[i]) return false;
  board[i] = player;
  history.push({i, p: player});
  const result = checkWinner(board);
  if(result){
    setStatusWinner(result.winner, result.line || []);
  } else {
    currentPlayer = (player === 'X') ? 'O' : 'X';
    if(modeEl.value === 'pve' && currentPlayer === 'O'){
      setTimeout(aiMove, 150);
    }
  }
  render();
  return true;
}

function undo(){
  if(!history.length || isGameOver) return;
  const last = history.pop();
  board[last.i] = null;
  isGameOver = false;
  currentPlayer = last.p;
  render();
}

function aiMove(){
  if(isGameOver) return;
  const level = aiLevelEl.value;
  if(level === 'random'){
    const empties = board.map((v,i)=> v ? null : i).filter(v=>v!==null);
    const idx = empties[Math.floor(Math.random()*empties.length)];
    makeMove(idx, 'O');
  } else {
    const move = minimaxDecision(board, 'O');
    if(move !== null) makeMove(move, 'O');
  }
}

function minimaxDecision(bd, player){
  const avail = bd.map((v,i)=> v ? null : i).filter(v=>v!==null);
  if(avail.length === 9) return 4;
  let bestVal = -Infinity, bestMove = null;
  for(const idx of avail){
    const copy = bd.slice();
    copy[idx] = player;
    const val = minimax(copy, 0, false);
    if(val > bestVal){
      bestVal = val;
      bestMove = idx;
    }
  }
  return bestMove;
}

function minimax(bd, depth, isMaximizing){
  const res = checkWinner(bd);
  if(res){
    if(res.winner==='X') return -1;
    if(res.winner==='O') return 1;
    if(res.winner==='draw') return 0;
  }
  const avail = bd.map((v,i)=> v ? null : i).filter(v=>v!==null);
  if(isMaximizing){
    let best=-Infinity;
    for(const i of avail){
      bd[i]='O';
      best=Math.max(best, minimax(bd,depth+1,false));
      bd[i]=null;
    }
    return best;
  } else {
    let best=Infinity;
    for(const i of avail){
      bd[i]='X';
      best=Math.min(best, minimax(bd,depth+1,true));
      bd[i]=null;
    }
    return best;
  }
}

cells.forEach(c=>c.addEventListener('click', e=>{
  const i=Number(e.currentTarget.dataset.index);
  if(modeEl.value==='pve' && currentPlayer==='O') return;
  makeMove(i,currentPlayer);
}));

resetBtn.addEventListener('click', ()=>{
  board=Array(9).fill(null);
  history=[];
  isGameOver=false;
  currentPlayer='X';
  render();
});

undoBtn.addEventListener('click', undo);

modeEl.addEventListener('change', ()=>{
  board=Array(9).fill(null);
  history=[];
  isGameOver=false;
  currentPlayer='X';
  render();
});

downloadBtn.addEventListener('click', ()=>{
  const payload={board,currentPlayer,scores,history,mode:modeEl.value,ai:aiLevelEl.value,time:new Date().toISOString()};
  const blob=new Blob([JSON.stringify(payload,null,2)],{type:'application/json'});
  const url=URL.createObjectURL(blob);
  const a=document.createElement('a');
  a.href=url;
  a.download='tic-tac-toe-board.json';
  a.click();
  URL.revokeObjectURL(url);
});

render();
</script>
</body>
</html>
